# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.186814287263, 0.186814287263,0.186814287263,0.186814287263,0.184209782241,0.123528402452,0.0526149169877,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0451727681869,0.0647837593907,0.141959333368,0.145637962955,0.145637962955,0.145637962955,0.145637962955,0.150059431265,0.150059431265,0.150059431265,0.150059431265,0.150059431265,0.126514312914,0.150059431265,0.150059431265,0.153509480538,0.149651370251,0.149651370251,0.143677313884,0.143677313884,0.143677313884,0.143677313884,0.127381192561,0.121389247853,0.0204861994127,0.010200390574,0.010200390574,0.010200390574,0.010200390574,0.010200390574,0.010200390574,0.010200390574,0.010200390574,0.010200390574,0.010200390574,0.010200390574)
L_hpd_M95=c(0.345399151835, 0.345399151835,0.345399151835,0.345399151835,0.345399151835,0.345399151835,0.301209731666,0.110737031976,0.101966169836,0.101966169836,0.101966169836,0.101966169836,0.101966169836,0.101966169836,0.101966169836,0.101966169836,0.101966169836,0.101966169836,0.110737031976,0.188471757624,0.227366993991,0.235343610498,0.237226823103,0.237226823103,0.237226823103,0.237226823103,0.237226823103,0.237226823103,0.237226823103,0.237226823103,0.237226823103,0.237226823103,0.362255852771,0.42446831003,0.458432226297,0.456930189513,0.456930189513,0.458432226297,0.458432226297,0.458432226297,0.458432226297,0.458432226297,0.458432226297,0.442170776865,0.387432131915,0.363049860255,0.363049860255,0.363049860255,0.362137000561,0.377942407223,0.397913201658,0.432591745013,0.432591745013,0.432591745013,0.432591745013)
M_hpd_m95=c(0.845598748135, 0.845598748135,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0984163780689,0.0908914652722,0.054295258155,0.0483828660889,0.0483828660889,0.0428351420164,0.0439846989887,0.041967044281,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887,0.0439846989887)
M_hpd_M95=c(1.52395486215, 1.52395486215,0.14221282649,0.14221282649,0.14221282649,0.14221282649,0.14221282649,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.140970376021,0.142967781653,0.140970376021,0.132575170849,0.12781265582,0.116545378454,0.114659673616,0.102568977349,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058,0.103449832058)
R_hpd_m95=c(-1.34731301386, -1.34731301386,0.0559730018259,0.0559730018259,0.0486765121973,-0.0405033309381,-0.0749594790893,-0.0875118809167,-0.0830479524648,-0.0817473612193,-0.0817473612193,-0.0817473612193,-0.0817473612193,-0.0817473612193,-0.0817473612193,-0.0817473612193,-0.0817473612193,-0.0830479524648,-0.0934345066263,-0.0817473612193,-0.0632152820892,0.00898789916796,0.0211419298877,0.0449322130085,0.0520923920206,0.0604931001547,0.0624757848382,0.0624757848382,0.0624757848382,0.0624757848382,0.0606144312898,0.0546319473269,0.0657164926326,0.0632899100323,0.0749417171094,0.0735697961836,0.0735697961836,0.0632899100323,0.0632899100323,0.0632899100323,0.0632899100323,0.0611208220194,0.0611208220194,-0.0323549388804,-0.0819398841199,-0.0778092768485,-0.0778092768485,-0.0778092768485,-0.0819398841199,-0.0778092768485,-0.0819398841199,-0.0819398841199,-0.0819398841199,-0.0819398841199,-0.0819398841199)
R_hpd_M95=c(-0.647782878932, -0.647782878932,0.230931174103,0.230931174103,0.230931174103,0.215188383223,0.187456101376,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,-0.00764500267716,0.0720761173105,0.111894981302,0.122543231968,0.14819601186,0.179685791494,0.170694370548,0.168539266428,0.168539266428,0.171182937656,0.171182937656,0.171182937656,0.171182937656,0.18295747403,0.302297122932,0.35680338247,0.393741993842,0.393741993842,0.393741993842,0.393741993842,0.393741993842,0.393741993842,0.393741993842,0.393741993842,0.39925189377,0.393741993842,0.321663521671,0.306253225685,0.306253225685,0.306253225685,0.295893042764,0.321663521671,0.333989043139,0.357668536548,0.357668536548,0.357668536548,0.357668536548)
L_mean=c(0.262307717057, 0.262307717057,0.262307717057,0.262269381406,0.261678722684,0.253932104052,0.152919328262,0.0749235377409,0.074176773942,0.0739737992871,0.0739737992871,0.0739737992871,0.0739737992871,0.0739737992871,0.0739737992871,0.0739737992871,0.0739737992871,0.0739737992871,0.0749568486365,0.0876324841373,0.171430140747,0.18850489677,0.188799551714,0.188799551714,0.188799551714,0.188758493971,0.188545490423,0.188545490423,0.188545490423,0.188545490423,0.189214156464,0.193510481774,0.222391689717,0.253205314411,0.279823508926,0.283142061701,0.284231788738,0.284272498938,0.283415922376,0.283415922376,0.283415922376,0.281959425427,0.282915692905,0.250341314208,0.195681014462,0.176310469327,0.173586775669,0.169897887127,0.16915047666,0.168016186905,0.171187060646,0.172753477962,0.172753477962,0.172753477962,0.172753477962)
M_mean=c(1.18011551848, 1.18011551848,0.125246714378,0.125246714378,0.125246714378,0.125246714378,0.125246714378,0.125045737648,0.124787137408,0.124556110739,0.124556110739,0.124556110739,0.124556110739,0.124556110739,0.124556110739,0.124556110739,0.124556110739,0.124014850423,0.124014850423,0.124014850423,0.124014850423,0.122089852599,0.105135190538,0.0884821006814,0.0847416467186,0.0830063853274,0.0802911883007,0.0758663585994,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425,0.0754033753425)
R_mean=c(-0.917807801423, -0.917807801423,0.137061002678,0.137022667027,0.136432008305,0.128685389674,0.0276726138838,-0.0501221999071,-0.050610363466,-0.0505823114517,-0.0505823114517,-0.0505823114517,-0.0505823114517,-0.0505823114517,-0.0505823114517,-0.0505823114517,-0.0505823114517,-0.0500410511357,-0.0490580017863,-0.0363823662855,0.047415290324,0.0664150441707,0.0836643611758,0.100317451032,0.104057904995,0.105752108644,0.108254302122,0.112679131823,0.11314211508,0.11314211508,0.113810781122,0.118107106431,0.146988314374,0.177801939068,0.204420133583,0.207738686359,0.208828413396,0.208869123595,0.208012547034,0.208012547034,0.208012547034,0.206556050084,0.207512317563,0.174937938866,0.12027763912,0.100907093984,0.0981834003268,0.0944945117844,0.0937471013178,0.0926128115626,0.095783685303,0.0973501026199,0.0973501026199,0.0973501026199,0.0973501026199)
trans=0.5
age=(0:(55-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.504275448927), xlim = c(-57.75,2.75), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.67635034837), xlim = c(-57.75,2.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.48204431525, 0.439177083147), xlim = c(-57.75,2.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-57.75,2.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()